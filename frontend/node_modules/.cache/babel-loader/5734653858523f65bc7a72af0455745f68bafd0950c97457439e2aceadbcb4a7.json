{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { copyToClipboard } from \"../utils/clipboard\";\nimport { useOrchestration } from \"./useOrchestration\";\n\n/**\n * AI ì‘ë‹µì„ íŒŒì‹±í•˜ê³  UIì— ë§žëŠ” ë©”ì‹œì§€ ê°ì²´ë¡œ ë³€í™˜\n */\nconst processAIResponse = result => {\n  if (!result || !result.result) {\n    console.error(\"AI ì‘ë‹µ ì˜¤ë¥˜: ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤\", result);\n    return {\n      id: \"error-\" + Date.now(),\n      type: \"assistant\",\n      content: \"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\",\n      timestamp: new Date(),\n      isError: true\n    };\n  }\n\n  // LangChainê³¼ ì§ì ‘ í†µì‹ í•˜ë¯€ë¡œ, ê²°ê³¼ê°€ ë°”ë¡œ contentê°€ ë¨\n  const responseContent = result.result;\n  return {\n    id: \"response-\" + Date.now(),\n    type: \"assistant\",\n    content: responseContent,\n    timestamp: new Date(),\n    // ì„±ëŠ¥ ë©”íŠ¸ë¦­ í¬í•¨\n    performance_metrics: result.performance_metrics,\n    model_info: result.model_info\n  };\n};\n\n/**\n * ì±„íŒ… ê¸°ëŠ¥ì„ ìœ„í•œ ì»¤ìŠ¤í…€ í›…\n * @param {string} projectId - í”„ë¡œì íŠ¸ ID\n * @param {string} projectName - í”„ë¡œì íŠ¸ ì´ë¦„\n * @param {Array} promptCards - í”„ë¡¬í”„íŠ¸ ì¹´ë“œ ë°°ì—´\n * @returns {Object} - ì±„íŒ… ê´€ë ¨ ìƒíƒœì™€ í•¨ìˆ˜ë“¤\n */\nexport const useChat = (projectId, projectName, promptCards = []) => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [copiedMessage, setCopiedMessage] = useState(null);\n  const [streamingMessageId, setStreamingMessageId] = useState(null);\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n  const {\n    isExecuting: isGenerating,\n    isStreaming,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration\n  } = useOrchestration(projectId);\n\n  // ì´ˆê¸° í™˜ì˜ ë©”ì‹œì§€ ì„¤ì • - ì œê±°ë¨ (ë¹ˆ ìƒíƒœë¡œ ì‹œìž‘)\n  useEffect(() => {\n    setMessages([]); // ë¹ˆ ë°°ì—´ë¡œ ì‹œìž‘\n  }, [projectName]);\n\n  // ë©”ì‹œì§€ ì¶”ê°€ ì‹œ ìŠ¤í¬ë¡¤ í•˜ë‹¨ìœ¼ë¡œ\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const scrollToBottom = useCallback(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, []);\n\n  /**\n   * ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì²˜ë¦¬ í•¨ìˆ˜\n   */\n  const handleStreamingResponse = useCallback((chunk, metadata) => {\n    console.log(\"ðŸ”„ ì²­í¬ ìˆ˜ì‹ :\", chunk, \"ë©”íƒ€ë°ì´í„°:\", metadata);\n    setMessages(prev => {\n      const updatedMessages = [...prev];\n      const streamingMsgIndex = updatedMessages.findIndex(msg => msg.id === streamingMessageId);\n      console.log(\"ðŸ“ ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì°¾ê¸°:\", {\n        streamingMessageId,\n        foundIndex: streamingMsgIndex,\n        totalMessages: updatedMessages.length\n      });\n      if (streamingMsgIndex !== -1) {\n        // ê¸°ì¡´ ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì—…ë°ì´íŠ¸\n        const currentContent = updatedMessages[streamingMsgIndex].content;\n        const newContent = currentContent + chunk;\n        console.log(\"ðŸ“ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸:\", {\n          ì´ì „ê¸¸ì´: currentContent.length,\n          ì²­í¬ê¸¸ì´: chunk.length,\n          ìƒˆê¸¸ì´: newContent.length\n        });\n        updatedMessages[streamingMsgIndex] = {\n          ...updatedMessages[streamingMsgIndex],\n          content: newContent,\n          isLoading: true,\n          isStreaming: true\n        };\n      } else {\n        console.error(\"âŒ ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ!\", {\n          streamingMessageId,\n          availableIds: updatedMessages.map(msg => msg.id)\n        });\n      }\n      return updatedMessages;\n    });\n\n    // ìŠ¤í¬ë¡¤ ì¡°ì •\n    scrollToBottom();\n  }, [streamingMessageId, scrollToBottom]);\n\n  /**\n   * ìŠ¤íŠ¸ë¦¬ë° ì™„ë£Œ ì²˜ë¦¬ í•¨ìˆ˜\n   */\n  const handleStreamingComplete = useCallback(result => {\n    var _result$result;\n    console.log(\"âœ… ìŠ¤íŠ¸ë¦¬ë° ì™„ë£Œ ì²˜ë¦¬:\", {\n      streamingMessageId,\n      resultLength: ((_result$result = result.result) === null || _result$result === void 0 ? void 0 : _result$result.length) || 0,\n      result: result.result,\n      timestamp: new Date().toISOString()\n    });\n    setMessages(prev => {\n      const updatedMessages = [...prev];\n      const streamingMsgIndex = updatedMessages.findIndex(msg => msg.id === streamingMessageId);\n      console.log(\"ðŸ“ ì™„ë£Œ ì²˜ë¦¬ - ë©”ì‹œì§€ ì°¾ê¸°:\", {\n        streamingMessageId,\n        foundIndex: streamingMsgIndex,\n        totalMessages: updatedMessages.length\n      });\n      if (streamingMsgIndex !== -1) {\n        var _result$result2;\n        // ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì™„ë£Œ ì²˜ë¦¬\n        updatedMessages[streamingMsgIndex] = {\n          ...updatedMessages[streamingMsgIndex],\n          content: result.result,\n          isLoading: false,\n          isStreaming: false,\n          performance_metrics: result.performance_metrics,\n          model_info: result.model_info,\n          timestamp: new Date()\n        };\n        console.log(\"âœ… ìµœì¢… ë©”ì‹œì§€ ì„¤ì •:\", {\n          content: result.result,\n          ê¸¸ì´: (_result$result2 = result.result) === null || _result$result2 === void 0 ? void 0 : _result$result2.length\n        });\n      } else {\n        console.error(\"âŒ ì™„ë£Œ ì²˜ë¦¬ - ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ!\");\n      }\n      return updatedMessages;\n    });\n\n    // ìŠ¤íŠ¸ë¦¬ë° ID ì´ˆê¸°í™”\n    setStreamingMessageId(null);\n\n    // ìŠ¤í¬ë¡¤ ì¡°ì •\n    scrollToBottom();\n  }, [streamingMessageId, scrollToBottom]);\n\n  /**\n   * ìŠ¤íŠ¸ë¦¬ë° ì˜¤ë¥˜ ì²˜ë¦¬ í•¨ìˆ˜\n   */\n  const handleStreamingError = useCallback(error => {\n    console.error(\"ìŠ¤íŠ¸ë¦¬ë° ì˜¤ë¥˜ ì²˜ë¦¬:\", error);\n\n    // ì˜¤ë¥˜ ë©”ì‹œì§€ë¡œ ë³€í™˜\n    setMessages(prev => {\n      const updatedMessages = [...prev];\n      const streamingMsgIndex = updatedMessages.findIndex(msg => msg.id === streamingMessageId);\n      if (streamingMsgIndex !== -1) {\n        updatedMessages[streamingMsgIndex] = {\n          ...updatedMessages[streamingMsgIndex],\n          content: \"ë©”ì‹œì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\",\n          isLoading: false,\n          isStreaming: false,\n          isError: true,\n          timestamp: new Date()\n        };\n      }\n      return updatedMessages;\n    });\n    setStreamingMessageId(null);\n  }, [streamingMessageId]);\n\n  /**\n   * ë©”ì‹œì§€ ì „ì†¡ í•¨ìˆ˜\n   */\n  const handleSendMessage = useCallback(async () => {\n    if (!inputValue.trim() || isGenerating) return;\n    const userMessage = {\n      id: \"user-\" + Date.now(),\n      type: \"user\",\n      content: inputValue.trim(),\n      timestamp: new Date()\n    };\n\n    // ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ID ìƒì„±\n    const streamMsgId = \"streaming-\" + Date.now();\n    setStreamingMessageId(streamMsgId);\n\n    // ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µì„ ìœ„í•œ ì´ˆê¸° ë©”ì‹œì§€\n    const streamingMessage = {\n      id: streamMsgId,\n      type: \"assistant\",\n      content: \"\",\n      timestamp: new Date(),\n      isLoading: true,\n      isStreaming: true\n    };\n    setMessages(prev => [...prev, userMessage, streamingMessage]);\n    setInputValue(\"\");\n    try {\n      const orchestrationData = {\n        userInput: userMessage.content,\n        chat_history: messages.filter(msg => !msg.isLoading && !msg.isError).map(msg => ({\n          role: msg.type === \"user\" ? \"user\" : \"assistant\",\n          content: msg.content\n        }))\n      };\n\n      // ìŠ¤íŠ¸ë¦¬ë° ì˜µì…˜ ì„¤ì •\n      const streamingOptions = {\n        useStreaming: true,\n        chat_history: orchestrationData.chat_history,\n        onChunk: handleStreamingResponse,\n        onError: handleStreamingError,\n        onComplete: handleStreamingComplete\n      };\n\n      // ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰\n      await executeOrchestration(userMessage.content, streamingOptions);\n    } catch (error) {\n      console.error(\"ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:\", error);\n      handleStreamingError(error);\n    }\n  }, [inputValue, isGenerating, executeOrchestration, handleStreamingResponse, handleStreamingComplete, handleStreamingError, streamingMessageId, messages]);\n\n  /**\n   * Enter í‚¤ë¡œ ì „ì†¡\n   */\n  const handleKeyPress = useCallback(e => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  }, [handleSendMessage]);\n\n  /**\n   * ë©”ì‹œì§€ ë³µì‚¬\n   */\n  const handleCopyMessage = useCallback(async (content, messageId) => {\n    const success = await copyToClipboard(content);\n    if (success) {\n      setCopiedMessage(messageId);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * ê°œë³„ ì œëª© ë³µì‚¬\n   */\n  const handleCopyTitle = useCallback(async (title, messageId, index) => {\n    const success = await copyToClipboard(title, \"ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\");\n    if (success) {\n      setCopiedMessage(`${messageId}_title_${index}`);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * ì±„íŒ… ì´ˆê¸°í™” í•¨ìˆ˜\n   */\n  const resetChat = useCallback(() => {\n    setMessages([]);\n    setInputValue(\"\");\n    setCopiedMessage(null);\n    setStreamingMessageId(null);\n    resetOrchestration();\n  }, [resetOrchestration]);\n  return {\n    messages,\n    inputValue,\n    setInputValue,\n    copiedMessage,\n    isGenerating,\n    isStreaming,\n    streamingMessageId,\n    messagesEndRef,\n    inputRef,\n    handleSendMessage,\n    handleKeyPress,\n    handleCopyMessage,\n    handleCopyTitle,\n    resetChat,\n    scrollToBottom\n  };\n};\n_s(useChat, \"4zwP7swkVQhT+MzBnw1jaoS2Cb4=\", false, function () {\n  return [useOrchestration];\n});","map":{"version":3,"names":["useState","useEffect","useRef","useCallback","toast","copyToClipboard","useOrchestration","processAIResponse","result","console","error","id","Date","now","type","content","timestamp","isError","responseContent","performance_metrics","model_info","useChat","projectId","projectName","promptCards","_s","messages","setMessages","inputValue","setInputValue","copiedMessage","setCopiedMessage","streamingMessageId","setStreamingMessageId","messagesEndRef","inputRef","isExecuting","isGenerating","isStreaming","executeOrchestration","pollOrchestrationResult","resetOrchestration","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleStreamingResponse","chunk","metadata","log","prev","updatedMessages","streamingMsgIndex","findIndex","msg","foundIndex","totalMessages","length","currentContent","newContent","ì´ì „ê¸¸ì´","ì²­í¬ê¸¸ì´","ìƒˆê¸¸ì´","isLoading","availableIds","map","handleStreamingComplete","_result$result","resultLength","toISOString","_result$result2","ê¸¸ì´","handleStreamingError","handleSendMessage","trim","userMessage","streamMsgId","streamingMessage","orchestrationData","userInput","chat_history","filter","role","streamingOptions","useStreaming","onChunk","onError","onComplete","handleKeyPress","e","key","shiftKey","preventDefault","handleCopyMessage","messageId","success","setTimeout","handleCopyTitle","title","index","resetChat"],"sources":["/Users/yeong-gwang/Documents/work/á„‰á…¥á„‹á…®á†¯á„€á…§á†¼á„Œá…¦á„‰á…µá†«á„†á…®á†«/ai_á„Œá…¦á„†á…©á†¨á„ƒá…¡á†¯á„€á…µ(á„‰á…®)_á„‹á…ªá†«á„‰á…¥á†¼á„‡á…©á†«_á„‰á…³á„á…³á„…á…µá„†á…µá†¼á„€á…®á„’á…§á†« á„‡á…©á†¨á„‰á…¡á„‡á…©á†«/frontend/src/hooks/useChat.js"],"sourcesContent":["import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { copyToClipboard } from \"../utils/clipboard\";\nimport { useOrchestration } from \"./useOrchestration\";\n\n/**\n * AI ì‘ë‹µì„ íŒŒì‹±í•˜ê³  UIì— ë§žëŠ” ë©”ì‹œì§€ ê°ì²´ë¡œ ë³€í™˜\n */\nconst processAIResponse = (result) => {\n  if (!result || !result.result) {\n    console.error(\"AI ì‘ë‹µ ì˜¤ë¥˜: ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤\", result);\n    return {\n      id: \"error-\" + Date.now(),\n      type: \"assistant\",\n      content: \"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\",\n      timestamp: new Date(),\n      isError: true,\n    };\n  }\n\n  // LangChainê³¼ ì§ì ‘ í†µì‹ í•˜ë¯€ë¡œ, ê²°ê³¼ê°€ ë°”ë¡œ contentê°€ ë¨\n  const responseContent = result.result;\n\n  return {\n    id: \"response-\" + Date.now(),\n    type: \"assistant\",\n    content: responseContent,\n    timestamp: new Date(),\n    // ì„±ëŠ¥ ë©”íŠ¸ë¦­ í¬í•¨\n    performance_metrics: result.performance_metrics,\n    model_info: result.model_info,\n  };\n};\n\n/**\n * ì±„íŒ… ê¸°ëŠ¥ì„ ìœ„í•œ ì»¤ìŠ¤í…€ í›…\n * @param {string} projectId - í”„ë¡œì íŠ¸ ID\n * @param {string} projectName - í”„ë¡œì íŠ¸ ì´ë¦„\n * @param {Array} promptCards - í”„ë¡¬í”„íŠ¸ ì¹´ë“œ ë°°ì—´\n * @returns {Object} - ì±„íŒ… ê´€ë ¨ ìƒíƒœì™€ í•¨ìˆ˜ë“¤\n */\nexport const useChat = (projectId, projectName, promptCards = []) => {\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [copiedMessage, setCopiedMessage] = useState(null);\n  const [streamingMessageId, setStreamingMessageId] = useState(null);\n\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n\n  const {\n    isExecuting: isGenerating,\n    isStreaming,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration,\n  } = useOrchestration(projectId);\n\n  // ì´ˆê¸° í™˜ì˜ ë©”ì‹œì§€ ì„¤ì • - ì œê±°ë¨ (ë¹ˆ ìƒíƒœë¡œ ì‹œìž‘)\n  useEffect(() => {\n    setMessages([]); // ë¹ˆ ë°°ì—´ë¡œ ì‹œìž‘\n  }, [projectName]);\n\n  // ë©”ì‹œì§€ ì¶”ê°€ ì‹œ ìŠ¤í¬ë¡¤ í•˜ë‹¨ìœ¼ë¡œ\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = useCallback(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, []);\n\n  /**\n   * ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì²˜ë¦¬ í•¨ìˆ˜\n   */\n  const handleStreamingResponse = useCallback(\n    (chunk, metadata) => {\n      console.log(\"ðŸ”„ ì²­í¬ ìˆ˜ì‹ :\", chunk, \"ë©”íƒ€ë°ì´í„°:\", metadata);\n\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === streamingMessageId\n        );\n\n        console.log(\"ðŸ“ ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì°¾ê¸°:\", {\n          streamingMessageId,\n          foundIndex: streamingMsgIndex,\n          totalMessages: updatedMessages.length,\n        });\n\n        if (streamingMsgIndex !== -1) {\n          // ê¸°ì¡´ ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì—…ë°ì´íŠ¸\n          const currentContent = updatedMessages[streamingMsgIndex].content;\n          const newContent = currentContent + chunk;\n\n          console.log(\"ðŸ“ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸:\", {\n            ì´ì „ê¸¸ì´: currentContent.length,\n            ì²­í¬ê¸¸ì´: chunk.length,\n            ìƒˆê¸¸ì´: newContent.length,\n          });\n\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: newContent,\n            isLoading: true,\n            isStreaming: true,\n          };\n        } else {\n          console.error(\"âŒ ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ!\", {\n            streamingMessageId,\n            availableIds: updatedMessages.map((msg) => msg.id),\n          });\n        }\n\n        return updatedMessages;\n      });\n\n      // ìŠ¤í¬ë¡¤ ì¡°ì •\n      scrollToBottom();\n    },\n    [streamingMessageId, scrollToBottom]\n  );\n\n  /**\n   * ìŠ¤íŠ¸ë¦¬ë° ì™„ë£Œ ì²˜ë¦¬ í•¨ìˆ˜\n   */\n  const handleStreamingComplete = useCallback(\n    (result) => {\n      console.log(\"âœ… ìŠ¤íŠ¸ë¦¬ë° ì™„ë£Œ ì²˜ë¦¬:\", {\n        streamingMessageId,\n        resultLength: result.result?.length || 0,\n        result: result.result,\n        timestamp: new Date().toISOString(),\n      });\n\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === streamingMessageId\n        );\n\n        console.log(\"ðŸ“ ì™„ë£Œ ì²˜ë¦¬ - ë©”ì‹œì§€ ì°¾ê¸°:\", {\n          streamingMessageId,\n          foundIndex: streamingMsgIndex,\n          totalMessages: updatedMessages.length,\n        });\n\n        if (streamingMsgIndex !== -1) {\n          // ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì™„ë£Œ ì²˜ë¦¬\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: result.result,\n            isLoading: false,\n            isStreaming: false,\n            performance_metrics: result.performance_metrics,\n            model_info: result.model_info,\n            timestamp: new Date(),\n          };\n\n          console.log(\"âœ… ìµœì¢… ë©”ì‹œì§€ ì„¤ì •:\", {\n            content: result.result,\n            ê¸¸ì´: result.result?.length,\n          });\n        } else {\n          console.error(\"âŒ ì™„ë£Œ ì²˜ë¦¬ - ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ!\");\n        }\n\n        return updatedMessages;\n      });\n\n      // ìŠ¤íŠ¸ë¦¬ë° ID ì´ˆê¸°í™”\n      setStreamingMessageId(null);\n\n      // ìŠ¤í¬ë¡¤ ì¡°ì •\n      scrollToBottom();\n    },\n    [streamingMessageId, scrollToBottom]\n  );\n\n  /**\n   * ìŠ¤íŠ¸ë¦¬ë° ì˜¤ë¥˜ ì²˜ë¦¬ í•¨ìˆ˜\n   */\n  const handleStreamingError = useCallback(\n    (error) => {\n      console.error(\"ìŠ¤íŠ¸ë¦¬ë° ì˜¤ë¥˜ ì²˜ë¦¬:\", error);\n\n      // ì˜¤ë¥˜ ë©”ì‹œì§€ë¡œ ë³€í™˜\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === streamingMessageId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: \"ë©”ì‹œì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\",\n            isLoading: false,\n            isStreaming: false,\n            isError: true,\n            timestamp: new Date(),\n          };\n        }\n\n        return updatedMessages;\n      });\n\n      setStreamingMessageId(null);\n    },\n    [streamingMessageId]\n  );\n\n  /**\n   * ë©”ì‹œì§€ ì „ì†¡ í•¨ìˆ˜\n   */\n  const handleSendMessage = useCallback(async () => {\n    if (!inputValue.trim() || isGenerating) return;\n\n    const userMessage = {\n      id: \"user-\" + Date.now(),\n      type: \"user\",\n      content: inputValue.trim(),\n      timestamp: new Date(),\n    };\n\n    // ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ID ìƒì„±\n    const streamMsgId = \"streaming-\" + Date.now();\n    setStreamingMessageId(streamMsgId);\n\n    // ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µì„ ìœ„í•œ ì´ˆê¸° ë©”ì‹œì§€\n    const streamingMessage = {\n      id: streamMsgId,\n      type: \"assistant\",\n      content: \"\",\n      timestamp: new Date(),\n      isLoading: true,\n      isStreaming: true,\n    };\n\n    setMessages((prev) => [...prev, userMessage, streamingMessage]);\n    setInputValue(\"\");\n\n    try {\n      const orchestrationData = {\n        userInput: userMessage.content,\n        chat_history: messages\n          .filter((msg) => !msg.isLoading && !msg.isError)\n          .map((msg) => ({\n            role: msg.type === \"user\" ? \"user\" : \"assistant\",\n            content: msg.content,\n          })),\n      };\n\n      // ìŠ¤íŠ¸ë¦¬ë° ì˜µì…˜ ì„¤ì •\n      const streamingOptions = {\n        useStreaming: true,\n        chat_history: orchestrationData.chat_history,\n        onChunk: handleStreamingResponse,\n        onError: handleStreamingError,\n        onComplete: handleStreamingComplete,\n      };\n\n      // ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰\n      await executeOrchestration(userMessage.content, streamingOptions);\n    } catch (error) {\n      console.error(\"ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:\", error);\n      handleStreamingError(error);\n    }\n  }, [\n    inputValue,\n    isGenerating,\n    executeOrchestration,\n    handleStreamingResponse,\n    handleStreamingComplete,\n    handleStreamingError,\n    streamingMessageId,\n    messages,\n  ]);\n\n  /**\n   * Enter í‚¤ë¡œ ì „ì†¡\n   */\n  const handleKeyPress = useCallback(\n    (e) => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault();\n        handleSendMessage();\n      }\n    },\n    [handleSendMessage]\n  );\n\n  /**\n   * ë©”ì‹œì§€ ë³µì‚¬\n   */\n  const handleCopyMessage = useCallback(async (content, messageId) => {\n    const success = await copyToClipboard(content);\n    if (success) {\n      setCopiedMessage(messageId);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * ê°œë³„ ì œëª© ë³µì‚¬\n   */\n  const handleCopyTitle = useCallback(async (title, messageId, index) => {\n    const success = await copyToClipboard(title, \"ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\");\n    if (success) {\n      setCopiedMessage(`${messageId}_title_${index}`);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * ì±„íŒ… ì´ˆê¸°í™” í•¨ìˆ˜\n   */\n  const resetChat = useCallback(() => {\n    setMessages([]);\n    setInputValue(\"\");\n    setCopiedMessage(null);\n    setStreamingMessageId(null);\n    resetOrchestration();\n  }, [resetOrchestration]);\n\n  return {\n    messages,\n    inputValue,\n    setInputValue,\n    copiedMessage,\n    isGenerating,\n    isStreaming,\n    streamingMessageId,\n    messagesEndRef,\n    inputRef,\n    handleSendMessage,\n    handleKeyPress,\n    handleCopyMessage,\n    handleCopyTitle,\n    resetChat,\n    scrollToBottom,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}