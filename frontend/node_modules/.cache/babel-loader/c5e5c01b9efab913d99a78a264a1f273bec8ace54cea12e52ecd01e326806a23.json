{"ast":null,"code":"import{useState,useEffect,useRef,useCallback}from\"react\";/**\n * WebSocket Ïã§ÏãúÍ∞Ñ Ïä§Ìä∏Î¶¨Î∞çÏùÑ ÏúÑÌïú Ïª§Ïä§ÌÖÄ ÌõÖ\n */export const useWebSocket=projectId=>{const[isConnected,setIsConnected]=useState(false);const[isConnecting,setIsConnecting]=useState(false);const[error,setError]=useState(null);const wsRef=useRef(null);const reconnectTimeoutRef=useRef(null);const reconnectAttempts=useRef(0);const maxReconnectAttempts=5;// WebSocket URL (ÌôòÍ≤ΩÎ≥ÄÏàòÎÇò Ïã§Ï†ú Î∞∞Ìè¨Îêú URLÎ°ú ÏÑ§Ï†ï)\nconst getWebSocketUrl=useCallback(async()=>{const wsUrl=process.env.REACT_APP_WS_URL||\"wss://your-websocket-api.execute-api.us-east-1.amazonaws.com/prod\";// URL ÌòïÏãù Í≤ÄÏ¶ù Î∞è Ï†ïÍ∑úÌôî\nif(!wsUrl.startsWith(\"wss://\")&&!wsUrl.startsWith(\"ws://\")){console.error(\"ÏûòÎ™ªÎêú WebSocket URL ÌòïÏãù:\",wsUrl);return null;}// ÎÅùÏóê Ïä¨ÎûòÏãú Ï†úÍ±∞\nlet normalizedUrl=wsUrl.replace(/\\/$/,\"\");// Ïù∏Ï¶ù ÌÜ†ÌÅ∞ÏùÑ ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î°ú Ï∂îÍ∞Ä\ntry{var _session$tokens,_session$tokens$idTok;const{fetchAuthSession}=await import('aws-amplify/auth');const session=await fetchAuthSession();const token=session===null||session===void 0?void 0:(_session$tokens=session.tokens)===null||_session$tokens===void 0?void 0:(_session$tokens$idTok=_session$tokens.idToken)===null||_session$tokens$idTok===void 0?void 0:_session$tokens$idTok.toString();if(token){// URLÏóê ÌÜ†ÌÅ∞ÏùÑ ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î°ú Ï∂îÍ∞Ä\nnormalizedUrl+=`?token=${encodeURIComponent(token)}`;console.log(\"‚úÖ WebSocket URLÏóê Ïù∏Ï¶ù ÌÜ†ÌÅ∞ Ï∂îÍ∞ÄÎê®\");}else{console.log(\"‚ö†Ô∏è Ïù∏Ï¶ù ÌÜ†ÌÅ∞Ïù¥ ÏóÜÏùå - Í≥µÍ∞ú WebSocket Ïó∞Í≤∞ ÏãúÎèÑ\");}}catch(authError){console.log(\"üìù Ïù∏Ï¶ù ÌÜ†ÌÅ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®:\",authError.message);}console.log(\"WebSocket URL ÌôïÏù∏:\",normalizedUrl.replace(/token=[^&]+/,'token=***'));console.log(\"ÌôòÍ≤ΩÎ≥ÄÏàò REACT_APP_WS_URL:\",process.env.REACT_APP_WS_URL);return normalizedUrl;},[]);// WebSocket Ïó∞Í≤∞\nconst connect=useCallback(async()=>{var _wsRef$current,_wsRef$current2;// Ïù¥ÎØ∏ Ïó∞Í≤∞ Ï§ëÏù¥Í±∞ÎÇò Ïó∞Í≤∞Îêú Í≤ΩÏö∞ Ï§ëÎ≥µ Ïó∞Í≤∞ Î∞©ÏßÄ\nif(((_wsRef$current=wsRef.current)===null||_wsRef$current===void 0?void 0:_wsRef$current.readyState)===WebSocket.OPEN||((_wsRef$current2=wsRef.current)===null||_wsRef$current2===void 0?void 0:_wsRef$current2.readyState)===WebSocket.CONNECTING){console.log(\"Ïù¥ÎØ∏ Ïó∞Í≤∞Îêú WebSocketÏù¥ ÏûàÏäµÎãàÎã§ (readyState:\",wsRef.current.readyState,\")\");return;}// Ïù¥Ï†Ñ Ïó∞Í≤∞Ïù¥ ÏûàÎã§Î©¥ Ï†ïÎ¶¨\nif(wsRef.current){wsRef.current.close();wsRef.current=null;}setIsConnecting(true);setError(null);try{const wsUrl=await getWebSocketUrl();if(!wsUrl){setError(\"Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ WebSocket URL\");setIsConnecting(false);return;}console.log(\"WebSocket Ïó∞Í≤∞ ÏãúÎèÑ:\",wsUrl);console.log(\"Î∏åÎùºÏö∞Ï†Ä WebSocket ÏßÄÏõê:\",!!window.WebSocket);// Ïó∞Í≤∞ ÏãúÎèÑ ÏãúÍ∞Ñ Í∏∞Î°ù\nwindow.wsConnectStart=Date.now();wsRef.current=new WebSocket(wsUrl);// Ïó∞Í≤∞ ÏÉÅÌÉú Î™®ÎãàÌÑ∞ÎßÅ\nconst connectionTimeout=setTimeout(()=>{var _wsRef$current3;if(((_wsRef$current3=wsRef.current)===null||_wsRef$current3===void 0?void 0:_wsRef$current3.readyState)===WebSocket.CONNECTING){console.error(\"WebSocket Ïó∞Í≤∞ ÏãúÍ∞Ñ Ï¥àÍ≥º\");wsRef.current.close();setError(\"Ïó∞Í≤∞ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§\");setIsConnecting(false);}},10000);// 10Ï¥à ÌÉÄÏûÑÏïÑÏõÉ\nwsRef.current.onopen=event=>{var _wsRef$current4,_wsRef$current5,_wsRef$current6;clearTimeout(connectionTimeout);console.log(\"üü¢ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ!\");console.log(\"- Event:\",event);console.log(\"- URL:\",(_wsRef$current4=wsRef.current)===null||_wsRef$current4===void 0?void 0:_wsRef$current4.url);console.log(\"- Protocol:\",(_wsRef$current5=wsRef.current)===null||_wsRef$current5===void 0?void 0:_wsRef$current5.protocol);console.log(\"- Extensions:\",(_wsRef$current6=wsRef.current)===null||_wsRef$current6===void 0?void 0:_wsRef$current6.extensions);setIsConnected(true);setIsConnecting(false);setError(null);reconnectAttempts.current=0;};wsRef.current.onclose=event=>{clearTimeout(connectionTimeout);const connectionDuration=Date.now()-(window.wsConnectStart||0);console.log(\"üî¥ WebSocket Ïó∞Í≤∞ Ï¢ÖÎ£å:\");console.log(\"- Code:\",event.code);console.log(\"- Reason:\",event.reason||\"(no reason provided)\");console.log(\"- WasClean:\",event.wasClean);console.log(\"- Connection duration:\",connectionDuration+\"ms\");setIsConnected(false);setIsConnecting(false);// Ï¶âÏãú Ï¢ÖÎ£åÎêú Í≤ΩÏö∞ (500ms Ïù¥ÎÇ¥) - ÏÑúÎ≤Ñ Î¨∏Ï†ú\nif(connectionDuration<500){console.error(\"‚ö†Ô∏è WebSocketÏù¥ Ï¶âÏãú Ï¢ÖÎ£åÎê® - ÏÑúÎ≤Ñ Î¨∏Ï†ú Í∞ÄÎä•ÏÑ±\");// ÌäπÏ†ï ÏóêÎü¨ ÏΩîÎìúÏóê Îî∞Î•∏ ÏÑ∏Î∂ÑÌôîÎêú ÏóêÎü¨ Î©îÏãúÏßÄ\nlet errorMessage=\"ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\";switch(event.code){case 1006:errorMessage=\"ÎπÑÏ†ïÏÉÅÏ†ÅÏù∏ Ïó∞Í≤∞ Ï¢ÖÎ£å (ÎÑ§Ìä∏ÏõåÌÅ¨ Î¨∏Ï†ú Í∞ÄÎä•ÏÑ±)\";break;case 1002:errorMessage=\"ÌîÑÎ°úÌÜ†ÏΩú Ïò§Î•ò\";break;case 1003:errorMessage=\"ÏßÄÏõêÌïòÏßÄ ÏïäÎäî Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ\";break;case 1011:errorMessage=\"ÏÑúÎ≤Ñ ÎÇ¥Î∂Ä Ïò§Î•ò\";break;case 1001:errorMessage=\"ÏÑúÎ≤ÑÍ∞Ä Ï¢ÖÎ£åÎêòÏóàÏäµÎãàÎã§\";break;case 1012:errorMessage=\"ÏÑúÎ≤Ñ Ïû¨ÏãúÏûë Ï§ëÏûÖÎãàÎã§\";break;case 1013:errorMessage=\"ÎÇòÏ§ëÏóê Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî\";break;case 1014:errorMessage=\"ÏûòÎ™ªÎêú Í≤åÏù¥Ìä∏Ïõ®Ïù¥\";break;case 1015:errorMessage=\"TLS Ïó∞Í≤∞ Ïã§Ìå®\";break;}setError(errorMessage);return;}// ÏûêÎèô Ïû¨Ïó∞Í≤∞ (Ï†ïÏÉÅ Ï¢ÖÎ£åÍ∞Ä ÏïÑÎãå Í≤ΩÏö∞)\nif(event.code!==1000&&reconnectAttempts.current<maxReconnectAttempts){const delay=Math.min(1000*Math.pow(2,reconnectAttempts.current),30000);console.log(`üîÑ ${delay}ms ÌõÑ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ (${reconnectAttempts.current+1}/${maxReconnectAttempts})`);reconnectTimeoutRef.current=setTimeout(()=>{reconnectAttempts.current++;connect();},delay);}else if(reconnectAttempts.current>=maxReconnectAttempts){setError(\"ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ ÌöüÏàòÏóê ÎèÑÎã¨ÌñàÏäµÎãàÎã§.\");}};wsRef.current.onerror=error=>{var _wsRef$current7,_wsRef$current8;clearTimeout(connectionTimeout);console.error(\"üí• WebSocket Ïò§Î•ò:\",error);console.log(\"- ReadyState:\",(_wsRef$current7=wsRef.current)===null||_wsRef$current7===void 0?void 0:_wsRef$current7.readyState);console.log(\"- URL:\",(_wsRef$current8=wsRef.current)===null||_wsRef$current8===void 0?void 0:_wsRef$current8.url);setError(\"WebSocket Ïó∞Í≤∞ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§\");setIsConnecting(false);};}catch(err){console.error(\"üí• WebSocket ÏÉùÏÑ± Ïã§Ìå®:\",err);setError(\"WebSocket Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: \"+err.message);setIsConnecting(false);}},[getWebSocketUrl]);// WebSocket Ïó∞Í≤∞ Ìï¥Ï†ú\nconst disconnect=useCallback(()=>{if(reconnectTimeoutRef.current){clearTimeout(reconnectTimeoutRef.current);reconnectTimeoutRef.current=null;}if(wsRef.current){wsRef.current.close(1000,\"Manual disconnect\");wsRef.current=null;}setIsConnected(false);setIsConnecting(false);reconnectAttempts.current=0;},[]);// Î©îÏãúÏßÄ Ï†ÑÏÜ°\nconst sendMessage=useCallback(message=>{var _wsRef$current9;if(((_wsRef$current9=wsRef.current)===null||_wsRef$current9===void 0?void 0:_wsRef$current9.readyState)===WebSocket.OPEN){wsRef.current.send(JSON.stringify(message));return true;}else{console.error(\"WebSocketÏù¥ Ïó∞Í≤∞ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§\");setError(\"WebSocket Ïó∞Í≤∞Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§\");return false;}},[]);// Ïä§Ìä∏Î¶¨Î∞ç ÏöîÏ≤≠\nconst startStreaming=useCallback(function(userInput){let chatHistory=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let promptCards=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];let modelId=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;let conversationId=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let userSub=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;if(!isConnected){setError(\"WebSocket Ïó∞Í≤∞Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§\");return false;}const message={action:\"stream\",projectId,userInput,chat_history:chatHistory,prompt_cards:promptCards,modelId:modelId,conversationId:conversationId,userSub:userSub};console.log('WebSocket Î©îÏãúÏßÄ Ï†ÑÏÜ°:',{action:message.action,projectId:message.projectId,inputLength:userInput.length,historyLength:chatHistory.length,promptCardsCount:promptCards.length,conversationId:message.conversationId,userSub:message.userSub});return sendMessage(message);},[isConnected,projectId,sendMessage]);// Î©îÏãúÏßÄ Î¶¨Ïä§ÎÑà Îì±Î°ù\nconst addMessageListener=useCallback(listener=>{if(wsRef.current){wsRef.current.addEventListener(\"message\",listener);}},[]);// Î©îÏãúÏßÄ Î¶¨Ïä§ÎÑà Ï†úÍ±∞\nconst removeMessageListener=useCallback(listener=>{if(wsRef.current){wsRef.current.removeEventListener(\"message\",listener);}},[]);// Ïª¥Ìè¨ÎÑåÌä∏ ÎßàÏö¥Ìä∏ Ïãú Ïó∞Í≤∞, Ïñ∏ÎßàÏö¥Ìä∏ Ïãú Ìï¥Ï†ú\nuseEffect(()=>{// Ï¥àÍ∏∞ Ïó∞Í≤∞ ÏßÄÏó∞ÏùÑ ÌÜµÌï¥ React strict mode Ïù¥Ïäà ÌöåÌîº\nconst timer=setTimeout(()=>{connect();},100);return()=>{clearTimeout(timer);disconnect();};},[]);// ÏùòÏ°¥ÏÑ± Î∞∞Ïó¥ÏùÑ Îπà Î∞∞Ïó¥Î°ú Î≥ÄÍ≤Ω\n// projectId Î≥ÄÍ≤Ω Ïãú Ïû¨Ïó∞Í≤∞ (Ïù¥Ï†Ñ Í∞íÍ≥º ÎπÑÍµêÌïòÏó¨ Ïã§Ï†ú Î≥ÄÍ≤ΩÏãúÏóêÎßå)\nconst prevProjectIdRef=useRef(projectId);useEffect(()=>{if(prevProjectIdRef.current!==projectId&&isConnected&&projectId){console.log('ProjectId Î≥ÄÍ≤ΩÎê®, Ïû¨Ïó∞Í≤∞ Ï§ë:',prevProjectIdRef.current,'->',projectId);disconnect();setTimeout(connect,200);}prevProjectIdRef.current=projectId;},[projectId,isConnected]);// connect, disconnect ÏùòÏ°¥ÏÑ± Ï†úÍ±∞\nreturn{isConnected,isConnecting,error,connect,disconnect,sendMessage,startStreaming,addMessageListener,removeMessageListener};};","map":{"version":3,"names":["useState","useEffect","useRef","useCallback","useWebSocket","projectId","isConnected","setIsConnected","isConnecting","setIsConnecting","error","setError","wsRef","reconnectTimeoutRef","reconnectAttempts","maxReconnectAttempts","getWebSocketUrl","wsUrl","process","env","REACT_APP_WS_URL","startsWith","console","normalizedUrl","replace","_session$tokens","_session$tokens$idTok","fetchAuthSession","session","token","tokens","idToken","toString","encodeURIComponent","log","authError","message","connect","_wsRef$current","_wsRef$current2","current","readyState","WebSocket","OPEN","CONNECTING","close","window","wsConnectStart","Date","now","connectionTimeout","setTimeout","_wsRef$current3","onopen","event","_wsRef$current4","_wsRef$current5","_wsRef$current6","clearTimeout","url","protocol","extensions","onclose","connectionDuration","code","reason","wasClean","errorMessage","delay","Math","min","pow","onerror","_wsRef$current7","_wsRef$current8","err","disconnect","sendMessage","_wsRef$current9","send","JSON","stringify","startStreaming","userInput","chatHistory","arguments","length","undefined","promptCards","modelId","conversationId","userSub","action","chat_history","prompt_cards","inputLength","historyLength","promptCardsCount","addMessageListener","listener","addEventListener","removeMessageListener","removeEventListener","timer","prevProjectIdRef"],"sources":["/Users/yeong-gwang/Documents/work/·Ñâ·Ö•·Ñã·ÖÆ·ÜØ·ÑÄ·Öß·Üº·Ñå·Ö¶·Ñâ·Öµ·Ü´·ÑÜ·ÖÆ·Ü´/dev/nexus/title_generator_ver1/frontend/src/hooks/useWebSocket.js"],"sourcesContent":["import { useState, useEffect, useRef, useCallback } from \"react\";\n\n/**\n * WebSocket Ïã§ÏãúÍ∞Ñ Ïä§Ìä∏Î¶¨Î∞çÏùÑ ÏúÑÌïú Ïª§Ïä§ÌÖÄ ÌõÖ\n */\nexport const useWebSocket = (projectId) => {\n  const [isConnected, setIsConnected] = useState(false);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [error, setError] = useState(null);\n  const wsRef = useRef(null);\n  const reconnectTimeoutRef = useRef(null);\n  const reconnectAttempts = useRef(0);\n  const maxReconnectAttempts = 5;\n\n  // WebSocket URL (ÌôòÍ≤ΩÎ≥ÄÏàòÎÇò Ïã§Ï†ú Î∞∞Ìè¨Îêú URLÎ°ú ÏÑ§Ï†ï)\n  const getWebSocketUrl = useCallback(async () => {\n    const wsUrl =\n      process.env.REACT_APP_WS_URL ||\n      \"wss://your-websocket-api.execute-api.us-east-1.amazonaws.com/prod\";\n    \n    // URL ÌòïÏãù Í≤ÄÏ¶ù Î∞è Ï†ïÍ∑úÌôî\n    if (!wsUrl.startsWith(\"wss://\") && !wsUrl.startsWith(\"ws://\")) {\n      console.error(\"ÏûòÎ™ªÎêú WebSocket URL ÌòïÏãù:\", wsUrl);\n      return null;\n    }\n    \n    // ÎÅùÏóê Ïä¨ÎûòÏãú Ï†úÍ±∞\n    let normalizedUrl = wsUrl.replace(/\\/$/, \"\");\n    \n    // Ïù∏Ï¶ù ÌÜ†ÌÅ∞ÏùÑ ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î°ú Ï∂îÍ∞Ä\n    try {\n      const { fetchAuthSession } = await import('aws-amplify/auth');\n      const session = await fetchAuthSession();\n      const token = session?.tokens?.idToken?.toString();\n      \n      if (token) {\n        // URLÏóê ÌÜ†ÌÅ∞ÏùÑ ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î°ú Ï∂îÍ∞Ä\n        normalizedUrl += `?token=${encodeURIComponent(token)}`;\n        console.log(\"‚úÖ WebSocket URLÏóê Ïù∏Ï¶ù ÌÜ†ÌÅ∞ Ï∂îÍ∞ÄÎê®\");\n      } else {\n        console.log(\"‚ö†Ô∏è Ïù∏Ï¶ù ÌÜ†ÌÅ∞Ïù¥ ÏóÜÏùå - Í≥µÍ∞ú WebSocket Ïó∞Í≤∞ ÏãúÎèÑ\");\n      }\n    } catch (authError) {\n      console.log(\"üìù Ïù∏Ï¶ù ÌÜ†ÌÅ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®:\", authError.message);\n    }\n    \n    console.log(\"WebSocket URL ÌôïÏù∏:\", normalizedUrl.replace(/token=[^&]+/, 'token=***'));\n    console.log(\"ÌôòÍ≤ΩÎ≥ÄÏàò REACT_APP_WS_URL:\", process.env.REACT_APP_WS_URL);\n    \n    return normalizedUrl;\n  }, []);\n\n  // WebSocket Ïó∞Í≤∞\n  const connect = useCallback(async () => {\n    // Ïù¥ÎØ∏ Ïó∞Í≤∞ Ï§ëÏù¥Í±∞ÎÇò Ïó∞Í≤∞Îêú Í≤ΩÏö∞ Ï§ëÎ≥µ Ïó∞Í≤∞ Î∞©ÏßÄ\n    if (wsRef.current?.readyState === WebSocket.OPEN || \n        wsRef.current?.readyState === WebSocket.CONNECTING) {\n      console.log(\"Ïù¥ÎØ∏ Ïó∞Í≤∞Îêú WebSocketÏù¥ ÏûàÏäµÎãàÎã§ (readyState:\", wsRef.current.readyState, \")\");\n      return;\n    }\n\n    // Ïù¥Ï†Ñ Ïó∞Í≤∞Ïù¥ ÏûàÎã§Î©¥ Ï†ïÎ¶¨\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n\n    setIsConnecting(true);\n    setError(null);\n\n    try {\n      const wsUrl = await getWebSocketUrl();\n      \n      if (!wsUrl) {\n        setError(\"Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ WebSocket URL\");\n        setIsConnecting(false);\n        return;\n      }\n\n      console.log(\"WebSocket Ïó∞Í≤∞ ÏãúÎèÑ:\", wsUrl);\n      console.log(\"Î∏åÎùºÏö∞Ï†Ä WebSocket ÏßÄÏõê:\", !!window.WebSocket);\n\n      // Ïó∞Í≤∞ ÏãúÎèÑ ÏãúÍ∞Ñ Í∏∞Î°ù\n      window.wsConnectStart = Date.now();\n\n      wsRef.current = new WebSocket(wsUrl);\n\n      // Ïó∞Í≤∞ ÏÉÅÌÉú Î™®ÎãàÌÑ∞ÎßÅ\n      const connectionTimeout = setTimeout(() => {\n        if (wsRef.current?.readyState === WebSocket.CONNECTING) {\n          console.error(\"WebSocket Ïó∞Í≤∞ ÏãúÍ∞Ñ Ï¥àÍ≥º\");\n          wsRef.current.close();\n          setError(\"Ïó∞Í≤∞ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§\");\n          setIsConnecting(false);\n        }\n      }, 10000); // 10Ï¥à ÌÉÄÏûÑÏïÑÏõÉ\n\n      wsRef.current.onopen = (event) => {\n        clearTimeout(connectionTimeout);\n        console.log(\"üü¢ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ!\");\n        console.log(\"- Event:\", event);\n        console.log(\"- URL:\", wsRef.current?.url);\n        console.log(\"- Protocol:\", wsRef.current?.protocol);\n        console.log(\"- Extensions:\", wsRef.current?.extensions);\n        setIsConnected(true);\n        setIsConnecting(false);\n        setError(null);\n        reconnectAttempts.current = 0;\n      };\n\n      wsRef.current.onclose = (event) => {\n        clearTimeout(connectionTimeout);\n        const connectionDuration = Date.now() - (window.wsConnectStart || 0);\n        \n        console.log(\"üî¥ WebSocket Ïó∞Í≤∞ Ï¢ÖÎ£å:\");\n        console.log(\"- Code:\", event.code);\n        console.log(\"- Reason:\", event.reason || \"(no reason provided)\");\n        console.log(\"- WasClean:\", event.wasClean);\n        console.log(\"- Connection duration:\", connectionDuration + \"ms\");\n        \n        setIsConnected(false);\n        setIsConnecting(false);\n\n        // Ï¶âÏãú Ï¢ÖÎ£åÎêú Í≤ΩÏö∞ (500ms Ïù¥ÎÇ¥) - ÏÑúÎ≤Ñ Î¨∏Ï†ú\n        if (connectionDuration < 500) {\n          console.error(\"‚ö†Ô∏è WebSocketÏù¥ Ï¶âÏãú Ï¢ÖÎ£åÎê® - ÏÑúÎ≤Ñ Î¨∏Ï†ú Í∞ÄÎä•ÏÑ±\");\n          \n          // ÌäπÏ†ï ÏóêÎü¨ ÏΩîÎìúÏóê Îî∞Î•∏ ÏÑ∏Î∂ÑÌôîÎêú ÏóêÎü¨ Î©îÏãúÏßÄ\n          let errorMessage = \"ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.\";\n          switch(event.code) {\n            case 1006:\n              errorMessage = \"ÎπÑÏ†ïÏÉÅÏ†ÅÏù∏ Ïó∞Í≤∞ Ï¢ÖÎ£å (ÎÑ§Ìä∏ÏõåÌÅ¨ Î¨∏Ï†ú Í∞ÄÎä•ÏÑ±)\";\n              break;\n            case 1002:\n              errorMessage = \"ÌîÑÎ°úÌÜ†ÏΩú Ïò§Î•ò\";\n              break;\n            case 1003:\n              errorMessage = \"ÏßÄÏõêÌïòÏßÄ ÏïäÎäî Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ\";\n              break;\n            case 1011:\n              errorMessage = \"ÏÑúÎ≤Ñ ÎÇ¥Î∂Ä Ïò§Î•ò\";\n              break;\n            case 1001:\n              errorMessage = \"ÏÑúÎ≤ÑÍ∞Ä Ï¢ÖÎ£åÎêòÏóàÏäµÎãàÎã§\";\n              break;\n            case 1012:\n              errorMessage = \"ÏÑúÎ≤Ñ Ïû¨ÏãúÏûë Ï§ëÏûÖÎãàÎã§\";\n              break;\n            case 1013:\n              errorMessage = \"ÎÇòÏ§ëÏóê Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî\";\n              break;\n            case 1014:\n              errorMessage = \"ÏûòÎ™ªÎêú Í≤åÏù¥Ìä∏Ïõ®Ïù¥\";\n              break;\n            case 1015:\n              errorMessage = \"TLS Ïó∞Í≤∞ Ïã§Ìå®\";\n              break;\n          }\n          \n          setError(errorMessage);\n          return;\n        }\n\n        // ÏûêÎèô Ïû¨Ïó∞Í≤∞ (Ï†ïÏÉÅ Ï¢ÖÎ£åÍ∞Ä ÏïÑÎãå Í≤ΩÏö∞)\n        if (\n          event.code !== 1000 &&\n          reconnectAttempts.current < maxReconnectAttempts\n        ) {\n          const delay = Math.min(\n            1000 * Math.pow(2, reconnectAttempts.current),\n            30000\n          );\n          console.log(\n            `üîÑ ${delay}ms ÌõÑ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ (${\n              reconnectAttempts.current + 1\n            }/${maxReconnectAttempts})`\n          );\n\n          reconnectTimeoutRef.current = setTimeout(() => {\n            reconnectAttempts.current++;\n            connect();\n          }, delay);\n        } else if (reconnectAttempts.current >= maxReconnectAttempts) {\n          setError(\"ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ ÌöüÏàòÏóê ÎèÑÎã¨ÌñàÏäµÎãàÎã§.\");\n        }\n      };\n\n      wsRef.current.onerror = (error) => {\n        clearTimeout(connectionTimeout);\n        console.error(\"üí• WebSocket Ïò§Î•ò:\", error);\n        console.log(\"- ReadyState:\", wsRef.current?.readyState);\n        console.log(\"- URL:\", wsRef.current?.url);\n        setError(\"WebSocket Ïó∞Í≤∞ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§\");\n        setIsConnecting(false);\n      };\n\n    } catch (err) {\n      console.error(\"üí• WebSocket ÏÉùÏÑ± Ïã§Ìå®:\", err);\n      setError(\"WebSocket Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: \" + err.message);\n      setIsConnecting(false);\n    }\n  }, [getWebSocketUrl]);\n\n  // WebSocket Ïó∞Í≤∞ Ìï¥Ï†ú\n  const disconnect = useCallback(() => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n\n    if (wsRef.current) {\n      wsRef.current.close(1000, \"Manual disconnect\");\n      wsRef.current = null;\n    }\n\n    setIsConnected(false);\n    setIsConnecting(false);\n    reconnectAttempts.current = 0;\n  }, []);\n\n  // Î©îÏãúÏßÄ Ï†ÑÏÜ°\n  const sendMessage = useCallback((message) => {\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify(message));\n      return true;\n    } else {\n      console.error(\"WebSocketÏù¥ Ïó∞Í≤∞ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§\");\n      setError(\"WebSocket Ïó∞Í≤∞Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§\");\n      return false;\n    }\n  }, []);\n\n  // Ïä§Ìä∏Î¶¨Î∞ç ÏöîÏ≤≠\n  const startStreaming = useCallback(\n    (userInput, chatHistory = [], promptCards = [], modelId = null, conversationId = null, userSub = null) => {\n      if (!isConnected) {\n        setError(\"WebSocket Ïó∞Í≤∞Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§\");\n        return false;\n      }\n\n      const message = {\n        action: \"stream\",\n        projectId,\n        userInput,\n        chat_history: chatHistory,\n        prompt_cards: promptCards,\n        modelId: modelId,\n        conversationId: conversationId,\n        userSub: userSub,\n      };\n\n      console.log('WebSocket Î©îÏãúÏßÄ Ï†ÑÏÜ°:', {\n        action: message.action,\n        projectId: message.projectId,\n        inputLength: userInput.length,\n        historyLength: chatHistory.length,\n        promptCardsCount: promptCards.length,\n        conversationId: message.conversationId,\n        userSub: message.userSub\n      });\n\n      return sendMessage(message);\n    },\n    [isConnected, projectId, sendMessage]\n  );\n\n  // Î©îÏãúÏßÄ Î¶¨Ïä§ÎÑà Îì±Î°ù\n  const addMessageListener = useCallback((listener) => {\n    if (wsRef.current) {\n      wsRef.current.addEventListener(\"message\", listener);\n    }\n  }, []);\n\n  // Î©îÏãúÏßÄ Î¶¨Ïä§ÎÑà Ï†úÍ±∞\n  const removeMessageListener = useCallback((listener) => {\n    if (wsRef.current) {\n      wsRef.current.removeEventListener(\"message\", listener);\n    }\n  }, []);\n\n  // Ïª¥Ìè¨ÎÑåÌä∏ ÎßàÏö¥Ìä∏ Ïãú Ïó∞Í≤∞, Ïñ∏ÎßàÏö¥Ìä∏ Ïãú Ìï¥Ï†ú\n  useEffect(() => {\n    // Ï¥àÍ∏∞ Ïó∞Í≤∞ ÏßÄÏó∞ÏùÑ ÌÜµÌï¥ React strict mode Ïù¥Ïäà ÌöåÌîº\n    const timer = setTimeout(() => {\n      connect();\n    }, 100);\n    \n    return () => {\n      clearTimeout(timer);\n      disconnect();\n    };\n  }, []); // ÏùòÏ°¥ÏÑ± Î∞∞Ïó¥ÏùÑ Îπà Î∞∞Ïó¥Î°ú Î≥ÄÍ≤Ω\n\n  // projectId Î≥ÄÍ≤Ω Ïãú Ïû¨Ïó∞Í≤∞ (Ïù¥Ï†Ñ Í∞íÍ≥º ÎπÑÍµêÌïòÏó¨ Ïã§Ï†ú Î≥ÄÍ≤ΩÏãúÏóêÎßå)\n  const prevProjectIdRef = useRef(projectId);\n  useEffect(() => {\n    if (prevProjectIdRef.current !== projectId && isConnected && projectId) {\n      console.log('ProjectId Î≥ÄÍ≤ΩÎê®, Ïû¨Ïó∞Í≤∞ Ï§ë:', prevProjectIdRef.current, '->', projectId);\n      disconnect();\n      setTimeout(connect, 200);\n    }\n    prevProjectIdRef.current = projectId;\n  }, [projectId, isConnected]); // connect, disconnect ÏùòÏ°¥ÏÑ± Ï†úÍ±∞\n\n  return {\n    isConnected,\n    isConnecting,\n    error,\n    connect,\n    disconnect,\n    sendMessage,\n    startStreaming,\n    addMessageListener,\n    removeMessageListener,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}